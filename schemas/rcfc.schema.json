{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "RCFC Recipe Schema",
  "type": "object",
  "required": [
    "schema_version",
    "metadata",
    "project",
    "source",
    "audience_profile",
    "scope",
    "overlays",
    "ending",
    "captions",
    "render",
    "provider"
  ],
  "properties": {
    "schema_version": { "type": "string", "const": "0.1.0" },
    "metadata": {
      "type": "object",
      "required": ["title", "created"],
      "properties": {
        "title": { "type": "string" },
        "author": { "type": "string" },
        "created": { "type": "string" }
      },
      "additionalProperties": true
    },
    "timeline": { "type": "string" },
    "project": {
      "type": "object",
      "required": ["name", "repo_url"],
      "properties": {
        "name": { "type": "string" },
        "repo_url": { "type": "string" }
      },
      "additionalProperties": true
    },
    "source": {
      "type": "object",
      "required": ["commit_sha"],
      "properties": {
        "commit_sha": { "type": "string" }
      },
      "additionalProperties": true
    },
    "audience_profile": {
      "type": "string",
      "enum": ["general", "dev", "custom"]
    },
    "scope": {
      "type": "object",
      "required": ["include_episodes"],
      "properties": {
        "include_episodes": {
          "type": "array",
          "items": { "type": "string" },
          "minItems": 1
        },
        "include_bonus": {
          "type": "array",
          "items": { "type": "string" }
        }
      },
      "additionalProperties": true
    },
    "overlays": {
      "type": "object",
      "required": ["enabled", "density", "theme"],
      "properties": {
        "enabled": { "type": "boolean" },
        "density": { "type": "string", "enum": ["low", "medium", "high"] },
        "theme": { "type": "string" }
      },
      "additionalProperties": true
    },
    "ending": { "type": "string", "enum": ["agnostic", "meta"] },
    "captions": {
      "type": "object",
      "required": ["track", "language"],
      "properties": {
        "track": { "type": "string", "enum": ["general", "dev_glossary"] },
        "language": { "type": "string" }
      },
      "additionalProperties": true
    },
    "render": {
      "type": "object",
      "required": ["fps", "aspect", "resolution"],
      "properties": {
        "fps": { "type": "integer", "minimum": 1, "maximum": 120 },
        "aspect": { "type": "string" },
        "resolution": {
          "type": "string",
          "pattern": "^[0-9]+x[0-9]+$"
        }
      },
      "additionalProperties": true
    },
    "audio": {
      "type": "object",
      "properties": {
        "ambiences": { "type": "array", "items": { "type": "string" } },
        "stingers": { "type": "array", "items": { "type": "string" } }
      },
      "additionalProperties": true
    },
    "provider": {
      "type": "object",
      "required": ["name", "options"],
      "properties": {
        "name": { "type": "string", "enum": ["prebaked", "dummy", "sora"] },
        "options": { "type": "object" }
      },
      "additionalProperties": true
    },
    "social": {
      "type": "object",
      "properties": {
        "platforms": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["tiktok", "instagram", "youtube_shorts", "twitter", "linkedin", "facebook"]
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "trims": {
          "type": "object",
          "patternProperties": {
            "^[a-zA-Z0-9_-]+$": {
              "type": "object",
              "required": ["platform", "source_episode", "timing"],
              "properties": {
                "platform": {
                  "type": "string",
                  "enum": ["tiktok", "instagram", "youtube_shorts", "twitter", "linkedin", "facebook"]
                },
                "source_episode": {
                  "type": "string",
                  "description": "Episode identifier to extract content from"
                },
                "timing": {
                  "type": "object",
                  "required": ["start", "end"],
                  "properties": {
                    "start": {
                      "type": "string",
                      "pattern": "^([0-9]+):([0-5][0-9]):([0-5][0-9])(\\.([0-9]{1,3}))?$",
                      "description": "Start time in HH:MM:SS or HH:MM:SS.mmm format"
                    },
                    "end": {
                      "type": "string",
                      "pattern": "^([0-9]+):([0-5][0-9]):([0-5][0-9])(\\.([0-9]{1,3}))?$",
                      "description": "End time in HH:MM:SS or HH:MM:SS.mmm format"
                    },
                    "max_duration": {
                      "type": "integer",
                      "description": "Maximum duration in seconds for platform compliance"
                    }
                  },
                  "additionalProperties": false
                },
                "aspect_ratio": {
                  "type": "string",
                  "enum": ["9:16", "1:1", "4:5", "16:9"],
                  "description": "Target aspect ratio for the platform"
                },
                "hooks": {
                  "type": "object",
                  "properties": {
                    "opening_text": {
                      "type": "string",
                      "maxLength": 150
                    },
                    "cta": {
                      "type": "string",
                      "maxLength": 100
                    }
                  },
                  "additionalProperties": true
                },
                "overlays": {
                  "type": "object",
                  "properties": {
                    "enabled": { "type": "boolean" },
                    "style": {
                      "type": "string",
                      "enum": ["minimal", "engaging", "branded"]
                    }
                  },
                  "additionalProperties": true
                },
                "captions": {
                  "type": "object",
                  "properties": {
                    "enabled": { "type": "boolean" },
                    "style": {
                      "type": "string",
                      "enum": ["default", "word_highlight", "karaoke"]
                    },
                    "position": {
                      "type": "string",
                      "enum": ["top", "middle", "bottom"]
                    }
                  },
                  "additionalProperties": true
                },
                "music": {
                  "type": "object",
                  "properties": {
                    "track": { "type": "string" },
                    "volume": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 1
                    }
                  },
                  "additionalProperties": true
                },
                "metadata": {
                  "type": "object",
                  "properties": {
                    "title": { "type": "string" },
                    "description": { "type": "string" },
                    "tags": {
                      "type": "array",
                      "items": { "type": "string" }
                    },
                    "hashtags": {
                      "type": "array",
                      "items": {
                        "type": "string",
                        "pattern": "^#[a-zA-Z0-9_]+$"
                      }
                    }
                  },
                  "additionalProperties": true
                }
              },
              "additionalProperties": true
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": true
    }
  },
  "additionalProperties": true
}